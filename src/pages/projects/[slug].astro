---
import { getCollection } from 'astro:content';
import Layout from '@layouts/Layout.astro';

export async function getStaticPaths() {
  const projects = await getCollection('projects');
  return projects.map((project) => ({
    params: { slug: project.slug },
  }));
}

const { slug } = Astro.params;
const projects = await getCollection('projects');
const project = projects.find((p) => p.slug === slug);

if (!project) {
  throw new Error(`Project not found for slug: ${slug}`);
}
---

<Layout>
  <main class="py-12 px-6">
    <section class="max-w-screen-lg mx-auto">
      <div class="flex flex-col lg:flex-row items-center gap-8">
        <!-- Project Image -->
        <div class="flex-shrink-0 w-full lg:w-1/2">
          <!-- Dynamically render the image based on the project data -->
          <img src={project.data.imageUrl || '/assets/images/project.png'} alt={project.data.img_alt} class="rounded-xl shadow-lg" />
        </div>
        
        <!-- Project Details -->
        <div class="w-full lg:w-1/2">
          <h1 class="text-4xl font-semibold text-orange mb-4">{project.data.title}</h1>
          <p class="text-lg text-black dark:text-white mb-6">{project.data.description}</p>
          
          <!-- Tags Section -->
          <div class="flex flex-wrap gap-2 mb-6">
            {project.data.tags.map((tag) => (
              <span class="bg-orange text-white px-4 py-1 rounded-full text-sm font-medium">{tag}</span>
            ))}
          </div>

          <!-- Links -->
          <div class="flex gap-4">
            <a
              href={project.data.link}
              target="_blank"
              rel="noopener"
              class="inline-block px-6 py-3 bg-orange text-white rounded-lg shadow-lg hover:bg-orange-dark transition-colors"
            >
              View on GitHub
            </a>
            {/* You can also add a "Visit Site" button if applicable */}
          </div>
        </div>
      </div>

      <!-- Project Media or Additional Content -->
      {project.data.media && (
        <section class="mt-12">
          <h2 class="text-2xl font-semibold text-orange mb-4">Project Media</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            {project.data.media.map((mediaItem) => (
              <div class="bg-gray-200 p-4 rounded-xl shadow-md">
                <img
                  src={mediaItem.url}
                  alt={mediaItem.alt || 'Project Media'}
                  class="w-full h-64 object-cover rounded-md"
                />
                <p class="mt-2 text-sm text-black dark:text-white">{mediaItem.description}</p>
              </div>
            ))}
          </div>
        </section>
      )}
    </section>
  </main>
</Layout>
